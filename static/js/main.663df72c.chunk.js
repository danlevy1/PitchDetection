(this.webpackJsonpmusictwo=this.webpackJsonpmusictwo||[]).push([[0],{10:function(t,e,n){t.exports=n.p+"static/media/default.62c0ac55.sf2"},13:function(t,e,n){t.exports=n(40)},18:function(t,e,n){},39:function(t,e,n){},40:function(t,e,n){"use strict";n.r(e);var i=n(0),a=n.n(i),o=n(9),r=n.n(o),s=n(1),c=n(2),l=n(4),d=n(3),u=n(5),h=(n(18),function(){function t(e,n,i){Object(s.a)(this,t),this.api=e,this.currentTracks=n,this.totalTracks=i}return Object(c.a)(t,[{key:"changeTracks",value:function(){for(var t=[],e=[],n=1;n<this.totalTracks;n++)document.getElementById("t"+n).checked&&(t.push(this.api.score.tracks[n-1]),e.push(n-1));if(0!==t.length)this.api.renderTracks(t),this.currentTracks=e;else for(var i=0;i<this.currentTracks.length;i++){var a=this.currentTracks[i]+1;document.getElementById("t"+a).checked=!0}}}]),t}()),p=n(10),f=n.n(p),g=n(11),m=n.n(g),v=n(12),b=new(n.n(v).a)((function(t){var e,n,i,a,o,r=[-1,-1,-1,-1];t.setup=function(r){if(void 0!==r){a=r,e=document.getElementById("bC"),n=document.getElementById("aTS"),i=document.getElementById("wrapper");(o=t.createCanvas(n.clientWidth,n.clientHeight)).position(0,0),o.parent("sketch-holder")}else t.noLoop()},t.draw=function(){var o,s;if(-1!==r[0]&&-1!==r[1]&&(t.fill(255),t.rect(r[0],0,n.clientWidth-r[0],n.clientHeight),a&&a.note.midiVal>=0&&-1!==r[2]&&-1!==r[3]&&(t.stroke(255,0,255),t.strokeWeight(3),t.line(r[0],r[1],r[2],r[3]),t.noStroke()),r[2]=r[0],r[3]=r[1]),t.noStroke(),a){o=a.noteHeight,r[1]=o,t.fill(255,0,255);var c=e.getClientRects()[0].left.valueOf()+i.scrollLeft;if(s=[c-14,o+3.5],r[0]=s[0]-7,a.note.midiVal>=0&&(t.ellipse(c,o,10,10),a.note.isSharp&&t.text("#",s[0],s[1]),0!==a.belowOrAbove)){var l=a.belowOrAbove>0;t.stroke(0),t.strokeWeight(1);for(var d=l?a.topLine:a.firstLine-a.distanceBetweenLines,u=0;u<Math.abs(a.belowOrAbove);u++)l?d-=a.distanceBetweenLines:d+=a.distanceBetweenLines,t.line(c-7,d,c+7,d);t.noStroke()}}}})),k=function(){function t(){Object(s.a)(this,t)}return Object(c.a)(t,null,[{key:"setupPitchDetection",value:function(){var t=this;return new Promise((function(e,n){t.audioContext=new AudioContext,navigator.mediaDevices?navigator.mediaDevices.getUserMedia({audio:!0}).then((function(i){t.micStream=i,t.ml5Setup().then((function(n){t.pitchDetectionModel=n,e()})).catch((function(t){n("[error][PitchDetection] ".concat(t))}))})).catch((function(t){n()})):n("[warning][PitchDetection] Cannot access microphone")}))}},{key:"ml5Setup",value:function(){return this.label=document.querySelector("#frequency"),m.a.pitchDetection("./model/",this.audioContext,this.micStream).ready}},{key:"startPitchDetection",value:function(){var t=this;return setInterval((function(){b.redraw(),t.pitchDetectionModel.getPitch().then((function(e){t.displayMidi(e)})).catch((function(e){console.log("[error][PitchDetection] ".concat(e)),t.displayMidi(0)}))}),1)}},{key:"stopPitchDetection",value:function(t){clearInterval(t)}},{key:"displayMidi",value:function(t){if(t){var e=Math.log(t/440)/Math.log(2)*12+69;this.label.textContent=e,L.noteList.addNote(e),L.drawer.updateNote(L.noteList.average)}else this.label.textContent="No Pitch Detected",L.noteList.addNote(0),L.drawer.updateNote(L.noteList.average)}}]),t}(),y=function(){function t(e,n){Object(s.a)(this,t),this.topLine=e,this.distanceBetweenLines=n,this.firstLine=this.topLine+5*this.distanceBetweenLines,this.lowerLimit=61,this.upperLimit=81,this.lowerLimit2=40,this.upperLimit2=60,this.note=new w(60),this.belowOrAbove=0,this.noteHeight=0,this.updateNote(this.note.midiVal)}return Object(c.a)(t,[{key:"updateNote",value:function(t){this.note.updateNote(t),this.getHeightOfNote(),this.getExtraFeatures()}},{key:"getHeightOfNote",value:function(){if(-1!==this.note.midiVal){var t=[0,0,1,1,2,3,3,4,4,5,5,6],e=this.note.octave-4,n=t[this.note.midiVal%t.length]+7*e;this.noteHeight=this.firstLine-n*this.distanceBetweenLines/2}else this.noteHeight=this.firstLine}},{key:"getExtraFeatures",value:function(){if(-1!==this.note.midiVal){var t=[1,1,1,2,2,2,2,3,3,3,4,4,4,4],e=0;if(this.note.midiVal>=this.upperLimit?e=this.upperLimit:this.note.midiVal<=this.lowerLimit&&(e=-1*this.lowerLimit),0!==e){var n=Math.abs(Math.abs(e)-this.note.midiVal),i=4*Math.floor(n/t.length),a=n%t.length;a=t[a],this.belowOrAbove=i+a,e<0&&(this.belowOrAbove*=-1)}else this.belowOrAbove=0}else this.belowOrAbove=0}}]),t}(),w=function(){function t(e){Object(s.a)(this,t),this.updateNote(e)}return Object(c.a)(t,[{key:"updateNote",value:function(t){if(!this.midiVal||t!==this.midiVal){this.midiVal=t;var e=this.numToNote();this.charPart=e.charPart,this.octave=e.octave,this.isSharp=2===this.charPart.length}}},{key:"getOctave",value:function(){return Math.floor(this.midiVal/12)-1}},{key:"numToNote",value:function(){var t,e;if(-1===this.midiVal)t="-",e="";else{var n=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];t=n[this.midiVal%n.length],e=this.getOctave(this.midiVal)}return{charPart:t,octave:e}}}]),t}(),P=y,O=function(){function t(e){Object(s.a)(this,t),this.elements=[e],this.pointer=0,this.total=e,this.average=e,this.lowerPitchBound=21,this.upperPitchBound=127}return Object(c.a)(t,[{key:"addNote",value:function(t){this.elements.length<5?this.elements.push(t):(this.total-=this.elements[this.pointer],this.elements[this.pointer]=t,this.pointer=(this.pointer+1)%5),this.total+=t,this.average=Math.round(this.total/this.elements.length),(0===t||this.average<this.lowerPitchBound||this.average>this.upperPitchBound)&&(this.average=-1)}},{key:"updateBounds",value:function(t,e){this.lowerPitchBound=t,this.upperPitchBound=e}}]),t}(),L=function(){function t(){Object(s.a)(this,t)}return Object(c.a)(t,null,[{key:"initializeAPI",value:function(){var e=this;this.currentTracks=[0,1,2,3,4];var n={player:f.a,cursor:!0,tracks:this.currentTracks,layout:"horizontal",scrollElement:"#wrapper"};this.api=new window.alphaTab.platform.javaScript.AlphaTabApi(document.querySelector("#alpha-tab-container"),n),this.api.addPostRenderFinished((function(){e.alphaTabRenderFinished()})),t.api.addPlayerStateChanged((function(){e.alphaTabPlayerStateChanged(t.api.playerState)}))}},{key:"alphaTabRenderFinished",value:function(){var e=document.getElementById("rect_0"),n=document.getElementById("rect_1"),i=setInterval((function(){if(console.log("running",e),null!==e&&null!==n){clearInterval(i),console.log("Done",e);var a=e.y.animVal.value,o=n.y.animVal.value-a;t.drawer=new P(a+1,o),t.noteList=new O(0),t.noteList.updateBounds(55,82),b.setup(t.drawer),k.setupPitchDetection().then((function(){console.log("[info][AlphaTabRunner] Pitch Detection is ready")})).catch((function(t){console.log(t)}))}else e=document.getElementById("rect_0"),n=document.getElementById("rect_1")}),3)}},{key:"alphaTabPlayerStateChanged",value:function(e){1!==t.api.playerState?(b.background(255),k.stopPitchDetection(this.intervalID)):(this.intervalID=k.startPitchDetection(),console.log(this.intervalID))}}]),t}(),B=(n(39),function(t){function e(){var t,n;Object(s.a)(this,e);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=Object(l.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(a)))).state={tex:'\\title "Down by the Riverside"\n                \\subtitle "Arranged by: Brant Adams. B.M.I."\n                \\tempo 84\n                .\n            \n                \\track "Soprano"\n                \\staff {score} \\tuning piano \\instrument acousticgrandpiano \\ks G\n                r.1 |\n                r.2 :4 d3 e3 |\n                g3{d}.2 :8 g3{-} a3 |\n                b3{d}.2 :8 b3{-} r |\n                \\ts 2 4 :4 b3 a3 |\n                \\ts 4 4 g3.1 |\n                :8 e3 d3 d3{- d}.2 :8 d3{-} r |\n                \\ts 2 4 :4 d3 e3 |\n                \\ts 4 4 g3{d}.2 :8 g3 a3 |\n                :2 b3 a3 |\n                g3.1 |\n                \\tempo 88\n                \\ts 4 4 :2 g3{-} r |\n            \n                \\track "Alto"\n                \\staff {score} \\tuning piano \\instrument acousticgrandpiano \\ks G\n                r.1 |\n                r.2 :4 d4 e4 |\n                g4.1 |\n                g4{- d}.2 :8 g4{-} r |\n                \\ts 2 4 f4.2 |\n                \\ts 4 4 :2 e4 c4 |\n                :8 c4 d4 d4{-}.2 :8 d4{-} r |\n                \\ts 2 4 :4 d4 e4 |\n                \\ts 4 4 g4{d}.2 e4.4 |\n                e4.2 :4 e4 c4 |\n                c4.1 |\n                \\tempo 88\n                \\ts 4 4 :2 b3 r |\n            \n                \\track "Tenor"\n                \\staff {score} \\tuning piano \\instrument acousticgrandpiano \\ks G \\clef F4\n                :1 r | r | r | r | \\ts 2 4 r.2 | \\ts 4 4 :1 r | r |\n                \\ts 2 4 :4 d4 c4 |\n                \\ts 4 4 b3.1 |\n                :2 g3 a3 |\n                ab3.1 |\n                \\tempo 88\n                \\ts 4 4 :2 g3 r |\n            \n                \\track "Bass"\n                \\staff {score} \\tuning piano \\instrument acousticgrandpiano \\ks G \\clef F4\n                :1 r | r | r | r | \\ts 2 4 r.2 | \\ts 4 4 :1 r | r | \\ts 2 4 r.2 |\n                \\ts 4 4 :4 g3 f3 e3 d3 |\n                c#3.2 :4 c3 d3 |\n                eb3.1 |\n                \\tempo 88\n                \\ts 4 4 :2 d3 r |\n            \n                \\track "Piano Upper"\n                \\staff {score} \\tuning piano \\instrument acousticgrandpiano \\ks G\n                r.8 d6{d}.4 d6{-}.2 |\n                r.8 d6{d}.4 d6{-}.2 |\n                r.8 d6{d}.4 d6{-}.2 |\n                r.8 :4 d6{d} d6{-} :4 (e6 b6) |\n                \\ts 2 4 :4 d5 a4{-} |\n                \\ts 4 4 r.8 d6{d}.4 d6{-}.2 |\n                r.8 d6{d}.4 d6{-}.2 |\n                \\ts 2 4 d6{-}.2 |\n                \\ts 4 4 r.8 d6{d}.4 d6{-}.2 |\n                r.4 :16 a4 b4 c#5 e5 f#5.4 :16 a4 c5 e5 f#5 |\n                g5.4 :16 ab4 bb4 c5 eb5 :8{tu 3} f5 g5 ab5 :8{tu 3} bb5 c6 eb6 |\n                \\tempo 88\n                \\ts 12 8 (a5{d} b5{d} d6{d}).2 a4{d}.2 |\n            \n                \\staff {score} \\tuning piano \\instrument acousticgrandpiano \\ks G\n                r.8 :16 g5 a5 :8 f#5 d5 d5{-}.2 |\n                r.8 :16 g5 a5 :8 f#5 d5 d5{-}.2 |\n                r.8 :16 g5 a5 :8 f#5 d5 d5{-}.2 |\n                r.8 :16 g5 a5 :8 f#5 d5 d5{-}.2 |\n                \\ts 2 4 f4.2 |\n                \\ts 4 4 r.8 :16 g5 a5 :8 d5 e5 e5{-}.2 |\n                r.8 :16 a5 b5 :8 d5 e5 e5{-} a5 d6.4 |\n                \\ts 2 4 d6{-}.2 |\n                \\ts 4 4 r.8 :16 g5 a5 :8 f#5 d5 d5{-}.2 |\n                r.1 |\n                r.1 |\n                \\tempo 88\n                \\ts 12 8 :8 g2 d3 g3 a3 b3 d4 a4 d4 b3 a3 g3 d3 |\n            \n            \n                \\staff {score} \\tuning piano \\instrument acousticgrandpiano \\ks G\n                :1 (d4 g4) |\n                :1 (d4 g4) |\n                :1 (d4 g4) |\n                :1 (d4 g4) |\n                \\ts 2 4 :2 (d4{-} g4{-}) |\n                \\ts 4 4 :1 (e4 g4) |\n                :1 (c4 d4 g4) |\n                \\ts 2 4 d4.2 |\n                \\ts 4 4 :2 (d4 g4) (e4 g4) |\n                :16 b3 c#4 e4 g4 g4{-}.4 :16 a3 c4 d4 e4 :8 f#4 d4 |\n                :16 ab3 c4 eb4 g4 (ab3{- d} c4{- d} eb4{- d} g4{- d}).2 |\n                \\tempo 88\n                \\clef F4\n                \\ts 12 8 :1 g2{d} |',utilAPI:null},n.playPauseHandler=function(){L.api.playPause()},n.resumeAudioContextHandler=function(){k.audioContext.resume().then((function(){console.log(k.audioContext.state)})).catch((function(t){console.log("[error][MusicContainer] ".concat(t))}))},n}return Object(u.a)(e,t),Object(c.a)(e,[{key:"componentDidMount",value:function(){L.initializeAPI(),this.setState({utilAPI:new h(L.api,L.currentTracks,L.totalTracks)})}},{key:"render",value:function(){return a.a.createElement("section",null,a.a.createElement("div",{id:"wrapper"},a.a.createElement("div",{id:"sketch-holder"}),a.a.createElement("div",{id:"alpha-tab-container","data-tex":"true"},this.state.tex)),a.a.createElement("button",{onClick:this.playPauseHandler},"PLAY / PAUSE"),a.a.createElement("button",{onClick:this.resumeAudioContextHandler},"RESUME"),a.a.createElement("h2",{id:"frequency"},"TEST"))}}]),e}(i.Component)),E=function(t){function e(){return Object(s.a)(this,e),Object(l.a)(this,Object(d.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(c.a)(e,[{key:"render",value:function(){return a.a.createElement("div",{className:"App"},a.a.createElement(B,null))}}]),e}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(a.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[13,1,2]]]);
//# sourceMappingURL=main.663df72c.chunk.js.map